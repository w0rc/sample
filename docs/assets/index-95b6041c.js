var H=Object.defineProperty;var z=(d,e,n)=>e in d?H(d,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[e]=n;var N=(d,e,n)=>(z(d,typeof e!="symbol"?e+"":e,n),n),_=(d,e,n)=>{if(!e.has(d))throw TypeError("Cannot "+n)};var M=(d,e,n)=>(_(d,e,"read from private field"),n?n.call(d):e.get(d)),I=(d,e,n)=>{if(e.has(d))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(d):e.set(d,n)},O=(d,e,n,i)=>(_(d,e,"write to private field"),i?i.call(d,n):e.set(d,n),n);import{V as u,r as w,R as K,u as G,M as k,a as Q,B as Y,b as X,j as r,c as $,C as Z,O as J,d as ee,e as te}from"./vendor.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const b of a.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&i(b)}).observe(document,{childList:!0,subtree:!0});function n(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(l){if(l.ep)return;l.ep=!0;const a=n(l);fetch(l.href,a)}})();var E,L,D,F,q;class se{constructor(e,n=123456789,i=362436069,l=521288629){I(this,E,void 0);I(this,L,void 0);I(this,D,void 0);I(this,F,void 0);I(this,q,0);O(this,F,e===void 0?88675123:e>>>0),O(this,E,n>>>0),O(this,L,i>>>0),O(this,D,l>>>0);for(let a=0;a<32;a++)this.gen()}gen(){return O(this,q,M(this,E)^M(this,E)<<11),O(this,E,M(this,L)),O(this,L,M(this,D)),O(this,D,M(this,F)),O(this,F,(M(this,F)^M(this,F)>>>19^(M(this,q)^M(this,q)>>>8))>>>0),M(this,F)}rand(){return this.gen()/4294967296}range(e=0,n=10){return this.rand()*(n-e)+e}shuffle(e){const n=[];for(let i=0,l=0,a=e.length;i<a;i++)l=Math.floor(this.range(0,i)),n[i]=i!==l?n[l]:n[i],n[l]=e[i];return n}}E=new WeakMap,L=new WeakMap,D=new WeakMap,F=new WeakMap,q=new WeakMap;class ne{constructor(){N(this,"all");N(this,"notakes");N(this,"standard");N(this,"scramble");N(this,"vectors");N(this,"rotateAxes");const e=["R","L","U","D","F","B"],n=["M","E","S"],i=["x","y","z"],l=e.map(c=>c+"'"),a=e.map(c=>c+"2"),b=e.concat(l).concat(a),x=e.map(c=>c+"'2"),R=e.map(c=>c+"2'"),A=b.concat(x).concat(R),B=e.map(c=>c+"w"),C=e.map(c=>c+"'w"),s=e.map(c=>c+"w2"),S=B.concat(C).concat(s),W=e.map(c=>c+"'w2"),t=e.map(c=>c+"w2'"),m=S.concat(W).concat(t),g=n.map(c=>c+"'"),h=n.map(c=>c+"2"),o=n.concat(g).concat(h),f=n.map(c=>c+"'2"),p=n.map(c=>c+"2'"),j=o.concat(f).concat(p),v=i.map(c=>c+"'"),y=i.concat(v),P=i.map(c=>c+"2"),U=i.map(c=>c+"'2"),T=i.map(c=>c+"'2"),V=y.concat(P).concat(U).concat(T);this.all=Array.prototype.concat(A,j,m,V),this.notakes=Array.prototype.concat(A,j,m),this.standard=Array.prototype.concat(b,o,S,y),this.scramble=Array.prototype.concat(b),this.vectors=new Map([["R",new u(1,0,0)],["L",new u(-1,0,0)],["U",new u(0,1,0)],["D",new u(0,-1,0)],["F",new u(0,0,1)],["B",new u(0,0,-1)],["M",new u(-1,0,0)],["E",new u(0,-1,0)],["S",new u(0,0,1)],["x",new u(1,0,0)],["y",new u(0,1,0)],["z",new u(0,0,1)]]),this.rotateAxes=new Map([["R",new u(-1,0,0)],["L",new u(1,0,0)],["U",new u(0,-1,0)],["D",new u(0,1,0)],["F",new u(0,0,-1)],["B",new u(0,0,1)],["M",new u(1,0,0)],["E",new u(0,1,0)],["S",new u(0,0,-1)],["x",new u(-1,0,0)],["y",new u(0,-1,0)],["z",new u(0,0,-1)]])}getVector(e){const n=this.vectors.get(e);if(n)return n;throw new Error(e+" is not Rotation Symbol.")}getRotateAxis(e){const n=this.rotateAxes.get(e);if(n)return n;throw new Error(e+" is not Rotation Symbol.")}}const re=w.forwardRef(function(e,n){const i=new ne,l=new se(new Date().valueOf()),a=w.useRef(null),b=w.useRef(null),x=w.useRef("manual"),R=w.useRef({isRotation:!1,rotateSymbol:"",symbolVector:new u,currentAngle:0,targetAngle:0,rotateAxis:new u,history:[],rotateQueue:[]}),A=new K,B=w.useRef({mesh:null,tempMaterial:null}),{scene:C}=G();w.useEffect(()=>{const t=a.current;if(t){if(t.name!=="")return;{t.name="RubikCubeGroup";const m=.3,g=.8,h=!1,o=[new k({color:13382451,roughness:m,opacity:g,transparent:h}),new k({color:13395507,roughness:m,opacity:g,transparent:h}),new k({color:13421772,roughness:m,opacity:g,transparent:h}),new k({color:13421670,roughness:m,opacity:g,transparent:h}),new k({color:3394611,roughness:m,opacity:g,transparent:h}),new k({color:3355596,roughness:m,opacity:g,transparent:h})],f=3,p=-1,j=1.01;for(let v=0;v<f;v++)for(let y=0;y<f;y++)for(let P=0;P<f;P++){const U=new Q(new Y(1,1,1),o);U.position.set((v+p)*j+e.position.x,(y+p)*j+e.position.y,(P+p)*j+e.position.z),a.current.attach(U)}}}},[C,e]),X((t,m)=>{const g=a.current,h=R.current,o=B.current;if(g&&o){A.setFromCamera(new $(t.mouse.x,t.mouse.y),t.camera);const f=A.intersectObjects(g.children,!1);if(f.length>0){const p=f[0].object;o.mesh!==p&&(o.mesh&&o.mesh.material&&o.tempMaterial&&(o.mesh.material=o.tempMaterial),p.material&&(B.current={mesh:p,tempMaterial:p.material}),p.material=new k({color:16777215}))}else o.mesh&&o.tempMaterial&&(o.mesh.material=o.tempMaterial),B.current={mesh:null,tempMaterial:null}}if(g&&h)if(h.isRotation){const f=b.current;if(f){const p=m*e.moveSpeed;if(h.currentAngle+=p,f.rotateOnAxis(h.rotateAxis,p),h.currentAngle+p*1.5>h.targetAngle){f.rotateOnAxis(h.rotateAxis,h.targetAngle-h.currentAngle);const j=[];f.children.forEach(v=>{j.push(v)}),j.forEach(v=>{g.attach(v)}),h.isRotation=!1,e.onRotationFinished&&e.onRotationFinished(h.rotateSymbol)}}}else{const f=x.current;if(f==="manual"&&W(),f==="demo"&&s(l.shuffle(i.notakes).shift()),f==="order"||f==="reverse"){const p=R.current.rotateQueue.shift();p?s(p,f==="reverse"):(x.current="manual",e.onOrderFinished&&e.onOrderFinished())}}});const s=function(t,m){const g=i.all.find(f=>f===t);if(g===void 0){console.error("is NOT rotation symbol syntax:"+t);return}const h=a.current,o=R.current;if(h&&o)if(o.isRotation)console.log("rubikcube is busy.");else{o.rotateSymbol=g;const[f,...p]=o.rotateSymbol.split("");o.symbolVector=i.getVector(f),o.currentAngle=0,o.targetAngle=p.includes("2")?Math.PI:Math.PI*.5,o.rotateAxis=i.getRotateAxis(f),o.rotateAxis=p.includes("'")?o.rotateAxis.negate():o.rotateAxis;const j=b.current;if(j){const v=[];h.children.forEach(y=>{o.rotateSymbol.match(/[xyz]/)?v.push(y):o.rotateSymbol.match(/[w]/)?y.position.angleTo(o.symbolVector)<Math.PI*.526&&v.push(y):o.rotateSymbol.match(/[MES]/)?y.position.angleTo(o.symbolVector)>Math.PI*.476&&y.position.angleTo(o.symbolVector)<Math.PI*.526&&v.push(y):y.position.angleTo(o.symbolVector)<Math.PI*.476&&v.push(y)}),j.rotation.set(0,0,0),v.forEach(y=>{j.add(y)})}o.isRotation=!0,m?o.history.pop():o.history.push(o.rotateSymbol),e.onRotationStarted&&e.onRotationStarted(o.rotateSymbol),S.current.forEach((v,y)=>{y!=="w"&&y!=="W"&&S.current.set(y,!1)})}},S=w.useRef(new Map),W=()=>{const t=S.current;(t.get("w")||t.get("W"))&&t.get("r")&&s("Rw"),(t.get("w")||t.get("W"))&&t.get("l")&&s("Lw"),(t.get("w")||t.get("W"))&&t.get("u")&&s("Uw"),(t.get("w")||t.get("W"))&&t.get("d")&&s("Dw"),(t.get("w")||t.get("W"))&&t.get("f")&&s("Fw"),(t.get("w")||t.get("W"))&&t.get("b")&&s("Bw"),(t.get("w")||t.get("W"))&&t.get("R")&&s("R'w"),(t.get("w")||t.get("W"))&&t.get("L")&&s("L'w"),(t.get("w")||t.get("W"))&&t.get("U")&&s("U'w"),(t.get("w")||t.get("W"))&&t.get("D")&&s("D'w"),(t.get("w")||t.get("W"))&&t.get("F")&&s("F'w"),(t.get("w")||t.get("W"))&&t.get("B")&&s("B'w"),t.get("r")&&s("R"),t.get("l")&&s("L"),t.get("u")&&s("U"),t.get("d")&&s("D"),t.get("f")&&s("F"),t.get("b")&&s("B"),t.get("R")&&s("R'"),t.get("L")&&s("L'"),t.get("U")&&s("U'"),t.get("D")&&s("D'"),t.get("F")&&s("F'"),t.get("B")&&s("B'"),t.get("e")&&s("E"),t.get("m")&&s("M"),t.get("s")&&s("S"),t.get("E")&&s("E'"),t.get("M")&&s("M'"),t.get("S")&&s("S'"),t.get("x")&&s("x"),t.get("y")&&s("y"),t.get("z")&&s("z"),t.get("X")&&s("x'"),t.get("Y")&&s("y'"),t.get("Z")&&s("z'")};return w.useImperativeHandle(n,()=>{var t;return{onKeyDown:m=>{S.current.set(m,!0)},onKeyUp:m=>{S.current.set(m,!1)},setCubeMode:m=>{x.current=m},requestOrder:(...m)=>{var g;(g=R.current)==null||g.rotateQueue.push(...m),x.current="order",e.onOrderStarted&&e.onOrderStarted()},requestReverse:()=>{var g,h;const m=[...(g=R.current)==null?void 0:g.history].reverse().map(o=>o.indexOf("'")>0?o.replace("'",""):o.replace(/^(.)/,"$1'"));(h=R.current)==null||h.rotateQueue.push(...m),x.current="reverse",e.onOrderStarted&&e.onOrderStarted()},history:(t=R.current)==null?void 0:t.history}},[e]),r.jsxs(r.Fragment,{children:[r.jsx("group",{position:e.position,ref:a}),r.jsx("group",{position:e.position,ref:b})]})});const oe=w.forwardRef(function(e,n){const[i,l]=w.useState(!1),[a,b]=w.useState(!1),[x,R]=w.useState(!1),[A,B]=w.useState("");return w.useImperativeHandle(n,()=>({resetConsoles:()=>{b(!1),R(!1)}})),r.jsxs("div",{className:"Controller",children:[r.jsxs("div",{className:"table",children:[r.jsx("div",{children:r.jsx("label",{htmlFor:"speedInput",children:"Speed:"})}),r.jsx("div",{children:r.jsx("input",{type:"number",id:"speedInput",className:"speed",value:e.moveSpeed,onChange:C=>{const s=parseInt(C.target.value);isNaN(s)||s<=0?console.log("Speed must be >0."):e.requestSetSpeed(s)}})})]}),r.jsxs("div",{className:"inputSymbols",children:[r.jsx("label",{htmlFor:"inputSymbols",children:"InputSymbols:"}),r.jsx("br",{}),r.jsx("textarea",{id:"inputSymbols",value:A,onChange:C=>B(C.target.value)}),r.jsx("input",{type:"button",id:"orderBtn",value:"Order",className:x?"clicked":"",onClick:()=>{x||(e.requestOrder(A),e.requestModeChange("order")),R(!x)},disabled:i||x||a})]}),r.jsxs("div",{className:"history",children:[r.jsx("label",{htmlFor:"history",children:"History:"}),r.jsx("br",{}),r.jsx("textarea",{id:"history",value:e.history,readOnly:!0})]}),r.jsxs("div",{className:"table",children:[r.jsx("div",{children:r.jsx("label",{htmlFor:"demoBtn",children:"Demonstration:"})}),r.jsx("div",{children:r.jsx("input",{type:"button",id:"demoBtn",className:i?"clicked":"",value:i?"Stop":"Start",onClick:()=>{e.requestModeChange(i?"manual":"demo"),l(!i)},disabled:a||x})})]}),r.jsxs("div",{className:"table",children:[r.jsx("div",{children:r.jsx("label",{htmlFor:"reverseBtn",children:"Restore cube:"})}),r.jsx("div",{children:r.jsx("input",{type:"button",id:"reverseBtn",value:"Restore",className:a?"clicked":"",onClick:()=>{a||e.requestReverse(),b(!a)},disabled:i||x||a})})]})]})});function ie(){var C;const d=w.useRef(null),e=w.useRef(null),n=w.useRef(null),i=s=>{e.current&&e.current.onKeyDown(s.key)},l=s=>{e.current&&e.current.onKeyUp(s.key)},[a,b]=w.useState(4),[x,R]=w.useState(""),A=s=>{R(x+" "+s)},B=()=>{var s;(s=n.current)==null||s.resetConsoles()};return r.jsxs("div",{className:"App",children:[r.jsx("div",{className:"Canvas-Container",children:r.jsxs(Z,{className:"Canvas",tabIndex:0,onKeyDown:i,onKeyUp:l,camera:{position:new u(4,3.5,5)},ref:d,children:[r.jsx(J,{}),r.jsx("ambientLight",{intensity:1}),r.jsx("directionalLight",{position:[10,10,10],intensity:.8}),r.jsx("directionalLight",{position:[-10,-10,-10],intensity:.8}),r.jsx("directionalLight",{position:[10,10,10],intensity:.4}),r.jsx("directionalLight",{position:[10,-10,10],intensity:.4}),r.jsx("axesHelper",{args:[3]}),r.jsx("gridHelper",{args:[20,20],position:[0,-3,0]}),r.jsx("gridHelper",{args:[20,20],position:[0,7,-10],rotation:[Math.PI/2,0,0]}),r.jsx("gridHelper",{args:[20,20],position:[-10,7,0],rotation:[0,0,Math.PI/2]}),r.jsx(re,{position:new u(0,0,0),moveSpeed:a,onRotationFinished:A,onOrderFinished:B,ref:e})]})}),r.jsx(oe,{moveSpeed:a,requestSetSpeed:s=>b(s),requestModeChange:s=>{var S;(S=e.current)==null||S.setCubeMode(s)},requestOrder:s=>{var S;(S=e.current)==null||S.requestOrder(...s.split(" "))},requestReverse:()=>{var s;(s=e.current)==null||s.requestReverse()},history:(C=e.current)==null?void 0:C.history.join(" "),ref:n})]})}ee.createRoot(document.getElementById("root")).render(r.jsx(te.StrictMode,{children:r.jsx(ie,{})}));
